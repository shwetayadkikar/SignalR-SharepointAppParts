@model List<SharePointPollAppWeb.Models.SurveyModel>
@{
    ViewBag.Title = "Survey Page";
}

@if (Model != null && Model.Any())
{
    <h2>Hi @ViewBag.Username, please select one option as your vote</h2>

    foreach (var question in Model)
    {
        <div style="float:left;width:100%; display:none;" id="@question.SurveyId" class="survey">
            @Html.Partial("_SurveyQuestion", question)
        </div>
    }
    <div id="output" style="background-color:yellow;float:left;width:100%">

    </div>
    <input type="button" id="btnNext" value="Next >" style="margin:10px;float:right;" onclick="onNext()" />
}
else
{
    <div>No Surveys found.</div>
}


@section scripts{
    <link href="~/Content/toastr.css" rel="stylesheet" />
    <script src="~/Scripts/jquery-1.10.2.min.js"></script>
    <!--Reference the SignalR library. -->
    <script src="~/Scripts/jquery.signalR-2.2.0.min.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="~/signalr/hubs"></script>
    <script src="~/Scripts/toastr.min.js"></script>
    <script src="~/Scripts/SignalR.API.js"></script>

    <script type="text/javascript">

        function onNext() {
            debugger;
            var currentSuveyId = $(".survey:Visible").attr('id');
            var nextSurveyId = parseInt(currentSuveyId) + 1;
            $(".survey#" + currentSuveyId).hide();
            $(".survey#" + nextSurveyId).show();
            var nextToNextSurveyId = parseInt(nextSurveyId) + 1;
            if ($(".survey#" + nextToNextSurveyId).length > 0)
                $("#btnNext").show();
            else
                $("#btnNext").hide();
        }

        $(document).ready(function () {
            debugger;
            //$(".survey").hide();
            $(".survey#1").show();

            SignalR_API.startConnection(SignalR_API.initSender, '@ViewBag.GroupName');

        });
    </script>
}
